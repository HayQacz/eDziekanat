{% extends "base.html" %}
{% load dict_extras %}
{% block content %}
<div class="container">
  <h2>Plan zajęć: {{ start_of_week|date:"d.m.Y" }} - {{ end_of_week|date:"d.m.Y" }}</h2>
  <div class="d-flex justify-content-between mb-3">
      <a href="{% url 'schedule_week' %}?date={{ previous_week|date:'Y-m-d' }}" class="btn btn-secondary">Poprzedni tydzień</a>
      <a href="{% url 'schedule_week' %}?date={{ next_week|date:'Y-m-d' }}" class="btn btn-secondary">Następny tydzień</a>
  </div>
  <div class="row">
    {% for day in week_dates %}
      <div class="col-md-1 border text-center">
        <h5>{{ day|date:"D" }}</h5>
        <p>{{ day|date:"d.m" }}</p>
        <a href="{% url 'schedule_day' day=day|date:'Y-m-d' %}">Szczegóły</a>
        <hr>
        {% with lessons=lessons_by_day|dict_get:forloop.counter0 %}
          {% for lesson in lessons %}
            <div class="lesson" style="background-color:
              {% if lesson.lesson_type == 'wykład' %}#ffcccc
              {% elif lesson.lesson_type == 'laboratoria' %}#ccffcc
              {% elif lesson.lesson_type == 'audytoria' %}#ccccff
              {% elif lesson.lesson_type == 'kolokwium' %}#ffffcc
              {% elif lesson.lesson_type == 'kolokwium poprawkowe' %}#ffccff
              {% elif lesson.lesson_type == 'zaliczenie' %}#ccffff
              {% elif lesson.lesson_type == 'zaliczenie poprawkowe' %}#f0f0f0
              {% else %}#ffffff{% endif %};
              padding: 5px; margin-bottom: 5px; cursor: pointer;"
              data-toggle="popover" data-trigger="hover" title="{{ lesson.final_grade.subject_name }}"
              data-content="Godziny: {{ lesson.start_time }} - {{ lesson.end_time }}<br>Forma: {{ lesson.get_lesson_type_display }}<br>Obowiązkowe: {{ lesson.mandatory|yesno:'Tak,Nie' }}<br>{{ lesson.additional_info }}">
              {{ lesson.start_time|time:"H:i" }} - {{ lesson.end_time|time:"H:i" }}
            </div>
          {% endfor %}
        {% endwith %}
      </div>
    {% endfor %}
  </div>
  <div class="mt-3">
    <a href="{% url 'lesson_add' %}" class="btn btn-primary">Dodaj zajęcia</a>
  </div>
</div>

<script>
  $(function () {
    $('[data-toggle="popover"]').popover({html: true});
  });
</script>
{% endblock %}
